{"version":3,"file":"view-search.js","sources":["webpack:///search.vue","webpack:///treemap.vue","webpack:///./components/views/treemap.vue?c3cf","webpack:///./components/views/treemap.vue?a0a4","webpack:///./components/views/search.vue?f3ea","webpack:///./components/views/treemap.vue?ea43","webpack:///./components/views/search.vue","webpack:///./components/views/search.vue?3e8d","webpack:///./components/views/search.vue?64a9","webpack:///./components/views/treemap.vue","webpack:///./components/views/treemap.vue?53e3","webpack:///./components/views/treemap.vue?d2bc","webpack:///./components/views/treemap.vue?1983"],"sourcesContent":["<template>\n    <div>\n        <list-tool-bar></list-tool-bar>\n        <list :bookmark-array=\"bookmarkArray\"></list>\n    </div>\n</template>\n\n<script>\n    import listToolBar from '../listToolBar'\n    import list from '../list'\n    import { bookmarks } from '../../libs/chrome'\n\n    export default {\n        name: 'search',\n        components: {\n            listToolBar,\n            list\n        },\n        data () {\n            return {\n                bookmarkArray: []\n            }\n        },\n        created () {\n            this.getData()\n        },\n        methods: {\n            async getData () {\n                let query = this.$route.params.query\n                this.bookmarkArray = await bookmarks.search(query)\n            }\n        },\n        watch: {\n            '$route' (to, from) {\n                this.getData()\n            },\n            '$store.state.ui.list.reverse'(){\n                this.bookmarkArray.reverse()\n            }\n        }\n    }\n</script>\n\n<style lang=\"scss\" scoped>\n\n</style>","<template>\n    <div class=\"treeMapWrapper\">\n        <div id=\"chart\"></div>\n    </div>\n</template>\n\n<script>\n    import * as d3 from 'd3'\n    import { bookmarks } from '../../libs/chrome'\n\n    export default {\n        name: 'treemap',\n        mounted () {\n            bookmarks.getTree(true).then((data) => {\n                console.log('treemap data:', data)\n                this.drawTreeMap(data, this.$el, this.$el.clientWidth, this.$el.clientHeight)\n            })\n        },\n        methods: {\n            drawTreeMap (data, elm) {\n                let w = 100\n                let h = 100\n                let x = d3.scaleLinear().domain([0, w]).range([0, w]);\n                let y = d3.scaleLinear().domain([0, h]).range([0, h]);\n                let color = d3.scaleOrdinal().range(d3.schemeCategory10);\n                let treemap = d3.treemap()\n                    //.tile(d3.treemapResquarify)\n                    .size([w, h])\n                    //.paddingOuter(0.5)\n                    //.paddingTop(5)\n                    .round(false);\n\n                const treeNodes = d3.hierarchy(data[0])\n                    .sum((d) => d.value)\n                  /*  .sort(function (a, b) {\n                        return b.height - a.height || b.value - a.value\n                    })*/\n\n                let currentDepth = treeNodes; // 初始节点为根节点\n\n                treemap(treeNodes);\n\n                console.log('生成的treemap数据结构 => ', treeNodes)\n\n                let $chart = d3.select('#chart')\n                let $cell\n\n                function drawTree (d) {\n\n                    $cell = $chart\n                        .selectAll('div')\n                        .data(d.descendants())\n                        .enter()\n                        .append('div')\n                        .attr(\"class\", function(d) { return `cell ${d.children ? 'is-parent' : ''}` })\n                        .attr('style', function (d) {\n                            return `left:${ x(d.x0) }%; top:${ y(d.y0) }%; width:${ x(d.x1) - x(d.x0) }%; height:${ y(d.y1) - y(d.y0) }%; background:${ color(d.data.title) }; z-index:${-d.depth};`\n                        })\n                        .on('click', function (d) {\n                            console.log('click cell:', d)\n                            //return zoom(currentDepth === d.parent ? treeNodes : d.parent);\n                        });\n\n                    let $text = $cell.append('div')\n                        .attr('class', 'text')\n                        .attr('style', function(d) {\n                            let pw = this.parentNode.offsetWidth\n                            console.info(d, pw)\n                            if( (d.x1-d.x0)<7 || (d.y1-d.y0)<2 ){\n                                return 'display:none;'\n                            }else{\n                                return ''\n                            }\n                        })\n\n                    $text.append('span')\n                        .attr('style', (d) => {\n                            return d.depth > 1 ? '' : 'display:none;'\n                        })\n                        .attr('class', 'hint--top')\n                        .attr('aria-label', '返回上一级')\n                        .append('i')\n                        .attr('class', 'fas fa-reply');\n\n                    $text.append('span').text((d) => {\n                        return d.data.title\n                    });\n\n                    $text.append('span')\n                        .attr('class', 'hint--top')\n                        .attr('aria-label', '选择当前文件夹')\n                        .append('i')\n                        .attr('class', 'check');\n                }\n\n                drawTree(treeNodes)\n\n                d3.select(elm).on('click', function () {\n                    zoom(treeNodes);\n                });\n\n                function zoom (d) {\n                    x.domain([d.x0, d.x1]);\n                    y.domain([d.y0, d.y1]);\n\n                    $cell.transition()\n                        .duration(400)\n                        .attr('style', (d) => {\n                        return `left:${ x(d.x0) }%; top:${ y(d.y0) }%; width:${ x(d.x1) - x(d.x0) }%; height:${ y(d.y1) - y(d.y0) }%;background:${ color(d.data.title) }; `\n                    })\n\n                    $cell // hide this depth and above\n                        .filter(function(d) { return d.ancestors(); })\n                        .classed(\"hide\", function(d) { return d.children ? true : false });\n\n                    $cell // show this depth + 1 and below\n                        .filter(function(d) { return d.depth > currentDepth; })\n                        .classed(\"hide\", false);\n\n                    currentDepth = d;\n                    d3.event.stopPropagation();\n                }\n            }\n        }\n    }\n</script>\n\n<style lang=\"scss\">\n    .treeMapWrapper {\n        width: 100%;\n        height: 100%;\n\n        #chart {\n            position: relative;\n            width: 100%;\n            height: 100%;\n        }\n\n        .cell {\n            position: absolute;\n            color: #fff;\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            white-space: nowrap;\n            //border:solid 1px #fff;\n            //margin: -1px 0 0 -1px;\n\n            &.is-parent{\n                justify-content: flex-start;\n                align-items: flex-start;\n            }\n\n            &.hide {\n                opacity: 0;\n                pointer-events: none;\n\n                .text {\n                    filter: blur(10px);\n                }\n            }\n\n            &:hover {\n               // z-index:100;\n                .text {\n                    color: hsla(0, 0, 100, 1);\n                }\n            }\n\n            &.level-0 {\n                z-index: 4;\n                font-size: 15vmin;\n                display: none;\n            }\n\n            &.level-1 {\n                z-index: 3;\n                font-size: 10vmin;\n            }\n\n            &.level-2 {\n                z-index: 2;\n                font-size: 5vmin;\n            }\n\n            &.level-3 {\n                z-index: 1;\n                font-size: 2.5vmin;\n            }\n\n            .text {\n                display: flex;\n                justify-content: center;\n                align-items: center;\n\n                span {\n                    margin: 0 5px;\n                    cursor: pointer;\n                }\n\n                .check {\n                    position: relative;\n                    display: inline-block;\n                    width: 1.4em;\n                    height: 1.4em;\n                    background: #fff;\n                    border-radius: 50%;\n                    vertical-align: middle;\n\n                    &.checked, &:hover {\n                        &:after {\n                            border-color: #1e7ec0;\n                        }\n                    }\n\n                    &:after {\n                        content: '';\n                        position: absolute;\n                        width: 1.5em;\n                        height: 1em;\n                        border: solid 2px #afacac;\n                        border-top: none;\n                        border-right: none;\n                        transform: rotate(-55deg);\n                        top: -0.1em;\n                    }\n                }\n            }\n\n        }\n    }\n</style>\n","exports = module.exports = require(\"../../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \".treeMapWrapper {\\n  width: 100%;\\n  height: 100%;\\n}\\n.treeMapWrapper #chart {\\n    position: relative;\\n    width: 100%;\\n    height: 100%;\\n}\\n.treeMapWrapper .cell {\\n    position: absolute;\\n    color: #fff;\\n    display: flex;\\n    justify-content: center;\\n    align-items: center;\\n    white-space: nowrap;\\n}\\n.treeMapWrapper .cell.is-parent {\\n      justify-content: flex-start;\\n      align-items: flex-start;\\n}\\n.treeMapWrapper .cell.hide {\\n      opacity: 0;\\n      pointer-events: none;\\n}\\n.treeMapWrapper .cell.hide .text {\\n        filter: blur(10px);\\n}\\n.treeMapWrapper .cell:hover .text {\\n      color: white;\\n}\\n.treeMapWrapper .cell.level-0 {\\n      z-index: 4;\\n      font-size: 15vmin;\\n      display: none;\\n}\\n.treeMapWrapper .cell.level-1 {\\n      z-index: 3;\\n      font-size: 10vmin;\\n}\\n.treeMapWrapper .cell.level-2 {\\n      z-index: 2;\\n      font-size: 5vmin;\\n}\\n.treeMapWrapper .cell.level-3 {\\n      z-index: 1;\\n      font-size: 2.5vmin;\\n}\\n.treeMapWrapper .cell .text {\\n      display: flex;\\n      justify-content: center;\\n      align-items: center;\\n}\\n.treeMapWrapper .cell .text span {\\n        margin: 0 5px;\\n        cursor: pointer;\\n}\\n.treeMapWrapper .cell .text .check {\\n        position: relative;\\n        display: inline-block;\\n        width: 1.4em;\\n        height: 1.4em;\\n        background: #fff;\\n        border-radius: 50%;\\n        vertical-align: middle;\\n}\\n.treeMapWrapper .cell .text .check.checked:after, .treeMapWrapper .cell .text .check:hover:after {\\n          border-color: #1e7ec0;\\n}\\n.treeMapWrapper .cell .text .check:after {\\n          content: '';\\n          position: absolute;\\n          width: 1.5em;\\n          height: 1em;\\n          border: solid 2px #afacac;\\n          border-top: none;\\n          border-right: none;\\n          transform: rotate(-55deg);\\n          top: -0.1em;\\n}\\n\", \"\"]);\n\n","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/lib/loader.js??ref--5-2!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./treemap.vue?vue&type=style&index=0&lang=scss&\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/lib/loader.js??ref--5-2!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./treemap.vue?vue&type=style&index=0&lang=scss&\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/lib/loader.js??ref--5-2!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./treemap.vue?vue&type=style&index=0&lang=scss&\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    [\n      _c(\"list-tool-bar\"),\n      _vm._v(\" \"),\n      _c(\"list\", { attrs: { \"bookmark-array\": _vm.bookmarkArray } })\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _vm._m(0)\n}\nvar staticRenderFns = [\n  function() {\n    var _vm = this\n    var _h = _vm.$createElement\n    var _c = _vm._self._c || _h\n    return _c(\"div\", { staticClass: \"treeMapWrapper\" }, [\n      _c(\"div\", { attrs: { id: \"chart\" } })\n    ])\n  }\n]\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./search.vue?vue&type=template&id=67d37ab8&scoped=true&\"\nimport script from \"./search.vue?vue&type=script&lang=js&\"\nexport * from \"./search.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"67d37ab8\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/j/dev/crx-bookmarks2/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('67d37ab8', component.options)\n    } else {\n      api.reload('67d37ab8', component.options)\n    }\n    module.hot.accept(\"./search.vue?vue&type=template&id=67d37ab8&scoped=true&\", function () {\n      api.rerender('67d37ab8', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"components/views/search.vue\"\nexport default component.exports","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./search.vue?vue&type=script&lang=js&\"","export * from \"-!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./search.vue?vue&type=template&id=67d37ab8&scoped=true&\"","import { render, staticRenderFns } from \"./treemap.vue?vue&type=template&id=72fc929c&\"\nimport script from \"./treemap.vue?vue&type=script&lang=js&\"\nexport * from \"./treemap.vue?vue&type=script&lang=js&\"\nimport style0 from \"./treemap.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/j/dev/crx-bookmarks2/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('72fc929c', component.options)\n    } else {\n      api.reload('72fc929c', component.options)\n    }\n    module.hot.accept(\"./treemap.vue?vue&type=template&id=72fc929c&\", function () {\n      api.rerender('72fc929c', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"components/views/treemap.vue\"\nexport default component.exports","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./treemap.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./treemap.vue?vue&type=script&lang=js&\"","import mod from \"-!../../../node_modules/style-loader/index.js??ref--5-0!../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/lib/loader.js??ref--5-2!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./treemap.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/style-loader/index.js??ref--5-0!../../../node_modules/css-loader/dist/cjs.js??ref--5-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/sass-loader/lib/loader.js??ref--5-2!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./treemap.vue?vue&type=style&index=0&lang=scss&\"","export * from \"-!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./treemap.vue?vue&type=template&id=72fc929c&\""],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAQA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAFA;AAAA;AACA;AADA;AAGA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AApBA;;;;;;;;;;;;;;;;;;;;;ACLA;AACA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAIA;AAJA;AAOA;AACA;AAAA;AACA;;;;AAIA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AAKA;AAAA;AAEA;AACA;AAEA;AAEA;AAEA;AAGA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAMA;AACA;AACA;AAEA;AAKA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AACA;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AACA;AAAA;AAGA;AACA;AACA;AACA;AAxGA;AARA;;;;;;;;;;;ACVA;AACA;AACA;AACA;;;;;;;;;;;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC5CA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AChBA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACjBA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACtCA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACvCA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;A","sourceRoot":""}