(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(t,e,n){"use strict";var r={name:"popup",props:{value:{type:Boolean,default:!0}},data(){return{exit:!1,visible:this.value}},methods:{close(){this.visible=!1,this.$emit("input",!1)},confirm(){},cancel(){this.closePopup(),this.$emit("cancel")}},watch:{value:function(t){console.log(t),this.visible=t}}},o=(n(564),n(5)),i=Object(o.a)(r,function(){var t=this.$createElement,e=this._self._c||t;return this.exit?this._e():e("div",{directives:[{name:"show",rawName:"v-show",value:this.visible,expression:"visible"}],staticClass:"popup-wrap"},[e("div",{staticClass:"mask",on:{click:this.close}}),this._v(" "),e("div",{staticClass:"popup"},[this._t("default")],2)])},[],!1,null,"f8da83aa",null).exports,a={name:"contextmenu",props:{value:!1},data:()=>({ev:!1,visible:!1,style:{}}),methods:{_style(){let t={};return this.ev&&((t=this.xy(this.ev)).transform="translate(0, 0)"),t},xy(t){let e=t.clientX,n=t.clientY,r=e,o=n,i=window.innerWidth,a=window.innerHeight,c=this.$el.offsetWidth,s=this.$el.offsetHeight;return e+c-i>0&&(r=e-(e+c-i)-20),n+s-a>0&&(o=n-(n+s-a)-20),{left:`${r}px`,top:`${o}px`}},cancelContextmenu(t){console.info("cancelContextmenu",t),this.ev=!1,this.visible=!1,this.style={},this.$emit("input",!1)}},watch:{value(t){this.ev=t,t?(this.$nextTick(()=>{this.style=this._style()}),document.addEventListener("click",this.cancelContextmenu,!1),document.addEventListener("scroll",this.cancelContextmenu,!0),document.addEventListener("contextmenu",this.cancelContextmenu,!0)):(document.removeEventListener("click",this.cancelContextmenu,!1),document.removeEventListener("scroll",this.cancelContextmenu,!0),document.removeEventListener("contextmenu",this.cancelContextmenu,!0))}}},c=(n(565),Object(o.a)(a,function(){var t=this.$createElement,e=this._self._c||t;return this.ev?e("div",{staticClass:"vueex-contextmenu",style:this.style},[this._t("default")],2):this._e()},[],!1,null,"4fd1f550",null).exports);
/*!
 * Making draggable objects
 * Created by j on 2019-01-15.
 */
class s{constructor(t,e){if(!(this instanceof s))return new s(t,e);this.dom=t,this.callback=e,this.startX=0,this.startY=0,this.downEvent=null,this.moveEvent=null;const n=this,r=this.dom,o=this.onDown=function(t){return t.preventDefault(),this.downEvent=t,n.startX=t.clientX,n.startY=t.clientY,document.addEventListener("mousemove",i),document.addEventListener("mouseup",a),!1},i=function(t){this.moveEvent=t;let e=t.clientX-n.startX,r=t.clientY-n.startY;return n.startX=t.clientX,n.startY=t.clientY,n.callback({moveX:e,moveY:r}),!1},a=function(t){document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",a)};r.addEventListener("mousedown",o,!1)}destroy(){this.dom.removeEventListener("mousedown",this.onDown)}}var u={name:"drag-resize-bar",props:{},data:()=>({info:null}),mounted(){this.bindDrag()},destroyed(){},methods:{bindDrag(){let t=this,e=this.$el;new s(e,function(e){t.$emit("resize",e)})}}},l=(n(566),Object(o.a)(u,function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"drag-resize-bar v"})},[],!1,null,"de345118",null).exports),f=n(29),h={name:"message",props:{show:Boolean,title:String,msg:String},data:()=>({})},v=(n(567),Object(o.a)(h,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vueex-msg-wrapper",class:{show:t.show}},[n("header",[t._v("\n        "+t._s(t.title)+"\n    ")]),t._v(" "),n("div",{staticClass:"body"},[t._v("\n        "+t._s(t.msg)+"\n    ")])])},[],!1,null,"3d512fc2",null).exports);
/*!
 * Created by j on 2019-01-26.
 */
let m;const d={data:{show:!1,title:"",msg:""},render(t){return t(v,{props:{show:this.show,title:this.title,msg:this.msg}})}};function p(){return m||((m=m||new f.a(d)).$mount(document.createElement("div")),document.body.appendChild(m.$el)),m}m=p();var b={$clone:t=>JSON.parse(JSON.stringify(t))};n.d(e,"b",function(){return i});
/*!
 * vue extension.
 * Created by j on 2019-01-11.
 */
const y={...b,$msg:function(t){"string"==typeof t&&(t={msg:t}),function(t){(m=p()).msg=t.msg,m.title=t.title,m.show=!0,setTimeout(()=>{m.show=!1},t.duration||3e3)}(t)}},k={contextmenu:c,dragResizeBar:l,popup:i},g={install:function(t,e={}){t.prototype;Object.keys(y).forEach(n=>{let r=y[n];if(n=e.alias&&e.alias[n]||n,t.prototype[n])throw new Error(`命名冲突, Vue.prototype.${n}已经存在, 可以通过options.alias.${n}={rename}重新命名.`);t.prototype[n]=r}),Object.keys(k).forEach(e=>{t.component(e,k[e])})}};e.a=g},158:function(t,e,n){},159:function(t,e,n){"use strict";var r=n(70);
/*!
 * define Vue mixins
 * Created by j on 2019-01-13.
 */e.a={methods:{editBookmark:r.b},watch:{"$root.event":function(t,e){console.log("mixins watch $root.event",this.name),this.getData&&this.getData()},"$store.state.ui.list.reverse":function(t){this.bookmarkArray&&this.bookmarkArray.reverse()}}}},160:function(t,e,n){},161:function(t,e,n){},162:function(t,e,n){},163:function(t,e,n){},164:function(t,e,n){},165:function(t,e,n){},171:function(t,e,n){},174:function(t,e,n){"use strict";var r=n(29),o=n(232),i=n(176);
/*!
 * 
 * Created by j on 2019-01-07.
 */
r.a.use(o.a),e.a=new o.a({routes:i.a,scrollBehavior:function(t,e,n){return{x:0,y:0}}})},175:function(t,e,n){"use strict";var r=n(54),o=n(159),i=n(6),a=n(22);function c(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}var u=Object(a.b)("shortcut"),l={name:"shortcut",mixins:[o.a],components:{listToolBar:r.a},data:function(){return{bookmarkArray:[]}},computed:{count:function(){return this.bookmarkArray.length}},created:function(){this.getData()},methods:{getData:function(){var t,e=(t=regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.get().then(function(t){return Object.keys(t)});case 2:return e=t.sent,t.next=5,i.a.get(e).then(function(t){var n=!0,r=!1,o=void 0;try{for(var i,a=t[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var c=i.value;c.shortcut=e.includes(c.id)}}catch(t){r=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(r)throw o}}return t});case 5:this.bookmarkArray=t.sent;case 6:case"end":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(t){s(i,r,o,a,c,"next",t)}function c(t){s(i,r,o,a,c,"throw",t)}a(void 0)})});return function(){return e.apply(this,arguments)}}(),onContextmenu:function(t){console.log("shortcut ",t);var e=t[0],n=t[1];if("remove"===e){var r=!0,o=!1,i=void 0;try{for(var a,s=this.bookmarkArray.entries()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=c(a.value,2),l=u[0],f=u[1];if(n.id===f.id)return this.bookmarkArray.splice(l,1)}}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}}}}},f=n(5),h={name:"home",components:{shortcut:Object(f.a)(l,function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("list-tool-bar",{attrs:{count:this.count}}),this._v(" "),e("list",{attrs:{bookmarkArray:this.bookmarkArray},on:{contextmenu:this.onContextmenu}})],1)},[],!1,null,"7536c242",null).exports}},v=Object(f.a)(h,function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("shortcut")],1)},[],!1,null,"301b6910",null);e.a=v.exports},176:function(t,e,n){"use strict";n(256),n(130);var r=n(175),o=n(178),i=n(54),a=n(69),c=n(6),s=n(22),u=n(28);function l(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=Object(s.b)("trash"),v={name:"trash",components:{toolBar:i.a,list:a.a},data:function(){return{bookmarkArray:[]}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){f(t,e,n[e])})}return t}({},Object(u.c)({reverse:function(t){return t.ui.list.reverse}})),created:function(){var t=this;this.getData();var e=function(e){console.log("db event listener",e),t.bookmarkArray.unshift(e[0])};h.on("add",e),this.$once("hook:beforeDestroy",function(){h.off("add",e)})},methods:{getData:function(){var t,e=(t=regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.get().then(function(t){return Object.values(t)});case 2:this.bookmarkArray=t.sent,this.reverse&&this.bookmarkArray.reverse();case 4:case"end":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(t){l(i,r,o,a,c,"next",t)}function c(t){l(i,r,o,a,c,"throw",t)}a(void 0)})});return function(){return e.apply(this,arguments)}}(),recover:function(t){c.a.recover(t),h.remove(t),this._remove(t)},remove:function(t){h.remove(t),this._remove(t)},clear:function(){confirm("确认清空回收站, 该操作不可撤销!")&&(h.clear(),this.bookmarkArray=[])},_remove:function(t){var e=this.bookmarkArray.findIndex(function(e){return e===t});this.bookmarkArray.splice(e,1)}},watch:{reverse:function(t){this.bookmarkArray.reverse()}}},m=n(5),d=Object(m.a)(v,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("tool-bar",[n("button",{staticClass:"flex-middle active",attrs:{title:"清空回收站"},on:{click:t.clear}},[n("i",{staticClass:"far fa-trash-alt"})])]),t._v(" "),n("list",{attrs:{bookmarkArray:t.bookmarkArray},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.bookmark;return[n("button",{attrs:{title:"恢复"},on:{click:function(e){return t.recover(r)}}},[n("i",{staticClass:"fa fa-undo"})]),t._v(" "),n("button",{on:{click:function(e){return t.remove(r)}}},[n("i",{staticClass:"far fa-trash-alt"})])]}}])})],1)},[],!1,null,"7f88be5d",null).exports;e.a=[{title:"首页",name:"home",path:"/home",component:r.a},{title:"常用",name:"hot",path:"/hot",component:function(){return n.e(0).then(n.bind(null,357))}},{title:"最近",name:"recent",path:"/recent",component:o.a},{title:"目录",name:"node",path:"/node/:id",_path:"/node/1",component:function(){return n.e(6).then(n.bind(null,887))}},{title:"",name:"treemap",path:"/treemap",component:function(){return Promise.all([n.e(1),n.e(0),n.e(7)]).then(n.bind(null,888))}},{title:"tree",name:"tree",path:"/tree",component:function(){return Promise.all([n.e(1),n.e(0),n.e(7)]).then(n.bind(null,356))}},{title:"回收站",name:"trash",path:"/trash",component:d},{title:"设置",name:"setting",path:"/setting",component:function(){return n.e(8).then(n.bind(null,889))}},{title:"search",name:"search",path:"/search/:query",component:function(){return Promise.all([n.e(1),n.e(0),n.e(7)]).then(n.bind(null,890))}},{path:"*",redirect:{path:"/recent"}}]},177:function(t,e,n){"use strict";
/*!
 * filter
 * Created by j on 2019-01-05.
 */function r(t){return"chrome://favicon/"+t}
/*!
 * 
 * Created by j on 2019-01-09.
 */var o={bind:function(t,e,n,r){},inserted:function(t,e,n,r){var o=e.value;console.log(e),t.onclick=function(t){this.classList.toggle(o)}},update:function(t,e,n,r){},componentUpdated:function(t,e,n,r){},unbind:function(t,e,n,r){t.onclick=void 0}},i=n(179),a=n(69),c=n(180),s=n(54),u={bookmarkEditor:i.a,list:a.a,listItem:c.a,listToolBar:s.a};
/*!
 * 
 * Created by j on 2019-01-09.
 */function l(t,e){return function(t){if(Array.isArray(t))return t}
/*!
 * register components in global
 * Created by j on 2019-01-26.
 */(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}e.a=function(t){t.filter("getFavicon",r),t.directive("toggle",o),t.prototype.$sortBookmarksBy=function(t,e){return t.sort(function(t,n){if("url"===e){var r=/^\w+:\/\/\/?([\w.]+)/i,o=t.url||"",i=n.url||"",a=o.match(r)||[],c=i.match(r)||[];return a=a[0]||"",c=c[0]||"",console.log(a,c),a===c?0:a.length-c.length}return"children"===e?(t.children?0:1)-(n.children?0:1):t[e]-n[e]})},Object.entries(u).forEach(function(e){var n=l(e,2),r=n[0],o=n[1];t.component(r,o)})}},178:function(t,e,n){"use strict";var r=n(69),o=n(54),i=n(6),a=n(28);function c(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u={name:"recent",components:{list:r.a,toolBar:o.a},data:function(){return{count:200,bookmarkArray:[]}},created:function(){this.getData()},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){s(t,e,n[e])})}return t}({},Object(a.c)({reverse:function(t){return t.ui.list.reverse}})),methods:{getData:function(){var t,e=(t=regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.a.getRecent(this.count);case 2:this.bookmarkArray=t.sent,this.reverse&&this.bookmarkArray.reverse();case 4:case"end":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(t){c(i,r,o,a,s,"next",t)}function s(t){c(i,r,o,a,s,"throw",t)}a(void 0)})});return function(){return e.apply(this,arguments)}}()},watch:{"$root.event":function(){this.getData()},reverse:function(t){this.bookmarkArray.reverse()}}},l=n(5),f=Object(l.a)(u,function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("tool-bar",{attrs:{count:this.count}}),this._v(" "),e("list",{attrs:{bookmarkArray:this.bookmarkArray}})],1)},[],!1,null,"4578391d",null);e.a=f.exports},179:function(t,e,n){"use strict";var r=n(6),o={name:"bookmarkEditor",props:{bookmark:Object},data:function(){return{msg:""}},methods:{save:function(){var t=this;r.a.update(this.bookmark).then(function(e){console.log("update",e),t.close()})},create:function(){var t=this;r.a.add(this.bookmark).then(function(e){t.close()})},cancel:function(){this.close()},close:function(){console.log("emit close",arguments),this.$emit("close")}}},i=(n(568),n(5)),a=Object(i.a)(o,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"bookmarkEditor"},[n("h3",[t._v("修改书签")]),t._v(" "),n("section",[n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[t._v("title")]),t._v(" "),n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.bookmark.title,expression:"bookmark.title"}],staticClass:"input",attrs:{type:"text"},domProps:{value:t.bookmark.title},on:{input:function(e){e.target.composing||t.$set(t.bookmark,"title",e.target.value)}}})])]),t._v(" "),t.bookmark.url?n("div",{staticClass:"field"},[n("label",{staticClass:"label"},[t._v("url")]),t._v(" "),n("div",{staticClass:"control"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.bookmark.url,expression:"bookmark.url"}],staticClass:"input",attrs:{type:"text"},domProps:{value:t.bookmark.url},on:{input:function(e){e.target.composing||t.$set(t.bookmark,"url",e.target.value)}}})])]):t._e(),t._v(" "),n("div",{staticClass:"field is-grouped is-grouped-centered"},[n("p",{staticClass:"control"},[n("button",{staticClass:"button is-light",on:{click:t.cancel}},[t._v(" 取消")])]),t._v(" "),n("p",{staticClass:"control"},[t.bookmark.id?n("button",{staticClass:"button is-primary",on:{click:t.save}},[t._v(" 保存")]):n("button",{staticClass:"button is-primary",on:{click:t.create}},[t._v(" 新建")])]),t._v(" "),n("p",{staticClass:"help"},[t._v("\n                "+t._s(t.msg)+"\n            ")])])])])},[],!1,null,"5a9f3fb8",null);e.a=a.exports},180:function(t,e,n){"use strict";var r=n(6),o=n(70),i=n(22),a=Object(i.b)("shortcut"),c={name:"listItem",props:{bookmark:Object},methods:{createSubFolder:function(t){Object(o.a)(t)},editBookmark:function(t){Object(o.b)(t)},remove:function(t){r.a.remove(t),this.$emit("contextmenu","remove",t)},addShortcut:function(t){a.set(t),this.$set(this.bookmark,"shortcut",!0)},removeShortcut:function(t){a.remove(t),this.$set(this.bookmark,"shortcut",!1)},open:function(t){return r.c.create({url:t,selected:!0}),!1}}},s=n(5),u=Object(s.a)(c,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("li",[t.bookmark.url?r("a",{attrs:{Xhref:t.bookmark.url,target:"_blank"},on:{click:function(e){return t.open(t.bookmark.url)}}},[r("img",{staticClass:"favicon",attrs:{src:t._f("getFavicon")(t.bookmark.url)}}),t._v(" "),r("span",[r("span",{staticClass:"tit"},[t._v(t._s(t.bookmark.title))]),t._v(" "),r("span",{staticClass:"url"},[t._v(t._s(t.bookmark.url))])])]):r("router-link",{attrs:{to:"/node/"+t.bookmark.id}},[r("img",{staticClass:"favicon",attrs:{src:n(569)}}),t._v(" "),r("span",{},[t._v(t._s(t.bookmark.title))])]),t._v(" "),r("div",{staticClass:"contextmenu"},[t._t("default",[t.bookmark.shortcut?r("button",{attrs:{title:"移除快捷方式"},on:{click:function(e){return t.removeShortcut(t.bookmark)}}},[r("i",{staticClass:"fas fa-unlink"})]):r("button",{attrs:{title:"加入快捷方式"},on:{click:function(e){return t.addShortcut(t.bookmark)}}},[r("i",{staticClass:"fas fa-link"})]),t._v(" "),t.bookmark.url?t._e():r("button",{attrs:{title:"新建子文件夹"},on:{click:function(e){return t.createSubFolder(t.bookmark)}}},[r("i",{staticClass:"fas fa-folder-plus"})]),t._v(" "),r("button",{attrs:{title:"编辑"},on:{click:function(e){return t.editBookmark(t.bookmark)}}},[r("i",{staticClass:"fas fa-edit"})]),t._v(" "),r("button",{attrs:{title:"删除"},on:{click:function(e){return t.remove(t.bookmark)}}},[r("i",{staticClass:"far fa-trash-alt"})])])],2)],1)},[],!1,null,"42431226",null);e.a=u.exports},181:function(t,e,n){"use strict";var r=n(29),o=n(28);function i(t,e){return function(t){if(Array.isArray(t))return t}
/*!
 * 
 * Created by j on 2019-01-22.
 */(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var a={config:{},ui:{state:{list:{reverse:!1,showType:"list",orderBy:"index"}},getters:{},actions:{},mutations:{updateUi:function(t,e){for(var n=i(e,2),r=n[0],o=n[1],a=r.split("."),c=t;a.length>=2;)c=c[a.shift()];c[a.shift()]=o}}}};
/*!
 * 
 * Created by j on 2019-01-07.
 */
r.a.use(o.a);e.a=new o.a.Store({modules:a})},22:function(t,e,n){"use strict";n.d(e,"b",function(){return h}),n.d(e,"a",function(){return l});var r=n(354),o=n.n(r);n(6);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}
/*!
 * 管理数据存储
 * Created by j on 2019-01-12.
 */var s=new o.a;window.addEventListener("storage",function(t){console.log("window.storage event",+new Date,t);var e=t.key,n=t.oldValue,r=t.newValue,o="",i=null,a=null,c=e.split(/[^\w]+/)[0];!n&&r?(o="add",i=r):n&&!r?(o="remove",i=n):n&&r&&(o="change",i=r);try{a=JSON.parse(i)}catch(o){console.log(o),a=null}u.forEach(function(e){e.namespace===c&&e.emit(o,a||i,t)})});var u=[];var l=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!(this instanceof t))return new t(e);this.namespace=e,this.separator=".",this._on={}}return c(t,null,[{key:"getAll",value:function(){return JSON.parse(JSON.stringify(localStorage))}},{key:"init",value:function(t){Object.entries(t).forEach(function(t){var e=t[0],n=t[1];console.log(e,n),localStorage.setItem(t[0],t[1])})}},{key:"remove",value:function(t){localStorage.removeItem(t)}}]),c(t,[{key:"on",value:function(t,e){t=this._prefix(t),u.includes(this)||u.push(this),this._on[t]=!0,s.on(t,e)}},{key:"off",value:function(t,e){var n,r,o;t=this._prefix(t),delete this._on[t],0===Object.keys(this._on).length&&(n=this,"number"==typeof(o=(r=u).findIndex(function(t){return t===n}))&&r.splice(o,0)),s.removeListener(t,e)}},{key:"emit",value:function(t){t=this._prefix(t);for(var e=this._prefix("*"),n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];this._on[e]?(r.unshift(t),s.emit(e,r)):this._on[t]?(r.push(t),s.emit(t,r)):console.log("Not listener for ",t,r,this)}},{key:"_prefix",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"".concat(this.namespace).concat(this.separator).concat(t)}}]),t}(),f={get:function(t){var e=this._prefix(),n={},r="object"===i(t)?t.id:t;if(r)return JSON.parse(localStorage.getItem(this._prefix(r)));for(var o in localStorage)0===o.indexOf(e)&&(n[r=o.replace(e,"")||this.namespace]=JSON.parse(localStorage[o]));return n},has:function(t){return this.get(t)},set:function(t){var e=t.id||Math.random().toFixed(8).replace("0.","");e=this._prefix(e),localStorage.setItem(e,JSON.stringify(t))},remove:function(t){var e="object"===i(t)?t.id:t;return localStorage.removeItem(this._prefix(e))},clear:function(){var t=this._prefix();for(var e in localStorage)0===e.indexOf(t)&&localStorage.removeItem(e)}};function h(t){return new l(t)}Object.keys(f).forEach(function(t){l.prototype[t]=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=this,i=f[t];return new Promise(function(e,r){var a=i.apply(o,n);console.log("Db ".concat(o.namespace," exec ").concat(t,"; args => "),n,"return =>",a);var c=n[0];/remove/.test(t)?o.emit("remove",c,a):/set/.test(t)?o.emit("change",c,a):/clear/.test(t)&&o.emit("clear",c,a),e(a)})}})},274:function(t,e,n){},275:function(t,e,n){},356:function(t,e,n){"use strict";n.r(e);var r=n(41),o=(n(578),n(6));function i(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}var a={name:"tree",created:function(){},mounted:function(){var t=this;this.getData().then(function(e){console.log(e);var n=t.$refs.chart;n.offsetWidth,n.offsetHeight;!function(t,e,n){var o=r.c().domain([0,100]).range([0,100]),i=r.c().domain([0,100]).range([0,100]),a=r.d().range(r.e),c=r.g().tile(r.h).size([100,100]).paddingInner(0).round(!1),s=r.b(t[0]).sum(function(t){return 1}),u=0,l=s;c(s),console.log("生成的treeMap数据结构 => ",s);var f=r.f(e).append("div").attr("class","nodesWrapper").selectAll(".node").data(s.descendants()).enter().append("div").attr("class",function(t){return"node level-".concat(t.depth)}).attr("x-title",function(t){return t.data.title});f.attr("style",function(t){return"left:".concat(o(t.x0),"%; top:").concat(i(t.y0),"%; width:").concat(o(t.x1)-o(t.x0),"%; height:").concat(i(t.y1)-i(t.y0),"%; z-index:").concat(1e3-t.depth,";")}).style("background-color",function(t){for(;t.depth>2;)t=t.parent;return a(t.data.title)}).on("click",function(t){m(t),l.data.id!==t.data.id||t.children?d(t):d(t.parent)});var h=f.append("div").attr("class","text");h.append("span").attr("style",function(t){return t.depth>1?"":"display:none;"}).attr("class","return-up hint--top").attr("aria-label",function(t){return"返回上一级:".concat(t.parent&&t.parent.data.title)}).on("click",function(t){console.log("@return",t.parent.data.title,t,t.parent),t.parent&&(m(t.parent),l.data.id===t.data.id?d(t.parent):t.parent&&d(t.parent.parent)),r.a.stopPropagation()}).append("i").attr("class","fas fa-reply"),h.append("span").attr("class","name hint--top").attr("aria-label",function(t){return"点击转到: ".concat(t.data.title)}).text(function(t){return t.data.title}).on("click",function(t){location.hash="#/node/"+t.data.id}),h.append("span").attr("class","check-box hint--top").attr("aria-label",function(t){return"选择当前文件夹: ".concat(t.data.title)}).append("i").attr("class","check").on("click",function(t){this.classList.toggle("checked"),n.$emit("selectFolderChange",t.data,t.path(s).reverse().map(function(t){return t.data.title})),r.a.stopPropagation()});var v=r.f("#path");function m(t){console.info("#updatePath",t);var e=v.selectAll("a").data(t.path(s).reverse());e.enter().append("a").merge(e).text(function(t){return t.data.title+" > "}).on("click",function(t){m(t),d(t)}),e.exit().remove()}function d(t){console.log("#zoom",t.data.title,t),u=t.depth,l=t,o.domain([t.x0,t.x1]),i.domain([t.y0,t.y1]),f.transition().duration(500).attr("style",function(t){return"left:".concat(o(t.x0),"%; top:").concat(i(t.y0),"%; width:").concat(o(t.x1)-o(t.x0),"%; height:").concat(i(t.y1)-i(t.y0),"%; background:").concat(a(t.data.title),";  z-index:").concat(1e3-t.depth,";")}),f.filter(function(t){return t.ancestors()}).classed("hide",function(t){return t.children}),f.filter(function(t){return t.depth>u}).classed("hide",!1)}m(s)}(e,n,t)})},methods:{getData:function(){var t,e=(t=regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.getTree(!0);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function c(t){i(a,r,o,c,s,"next",t)}function s(t){i(a,r,o,c,s,"throw",t)}c(void 0)})});return function(){return e.apply(this,arguments)}}()}},c=(n(877),n(5)),s=Object(c.a)(a,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"treeMapWrapper"},[e("header",{attrs:{id:"path"}}),this._v(" "),e("div",{ref:"chart",staticClass:"chart"})])},[],!1,null,"4cc06048",null);e.default=s.exports},357:function(t,e,n){"use strict";n.r(e);var r=n(6),o=n(22),i=n(69),a=n(54),c=n(159),s=n(28);function u(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f=Object(o.b)("visit"),h=Object(o.b)("shortcut"),v={name:"hot",mixins:[c.a],components:{toolBar:a.a,list:i.a},data:function(){return{bookmarkArray:[]}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){l(t,e,n[e])})}return t}({},Object(s.c)({reverse:function(t){return t.ui.list.reverse}}),{count:function(){return this.bookmarkArray.length}}),created:function(){var t=this;this.getData();var e=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];console.log("db event listener",n),t.getData()};f.on("*",e),this.$once("hook:beforeDestroy",function(){f.off("*",e)})},methods:{getData:function(){var t,e=(t=regeneratorRuntime.mark(function t(){var e,n,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.get();case 2:if(e=t.sent,!(n=Object.keys(e)).length){t.next=12;break}return t.next=7,r.a.get(n);case 7:(o=t.sent).forEach(function(t){t.visit=e[t.id]}),o.sort(function(t,e){return e.visit.count-t.visit.count}),this.reverse&&o.reverse(),this.bookmarkArray=o;case 12:case"end":return t.stop()}},t,this)}),function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(t){u(i,r,o,a,c,"next",t)}function c(t){u(i,r,o,a,c,"throw",t)}a(void 0)})});return function(){return e.apply(this,arguments)}}(),remove:function(t){r.a.remove(t)},edit:function(t){this.editBookmark(t)},addShortcut:function(t){h.set(t),this.$set(t,"shortcut",!0)},removeShortcut:function(t){h.remove(t),this.$set(t,"shortcut",!1)}},watch:{"$root.event":function(t){console.log("$root.event watcher => ",t),this.getData()}}},m=n(5),d=Object(m.a)(v,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("tool-bar",{attrs:{count:t.count}}),t._v(" "),n("list",{attrs:{"bookmark-array":t.bookmarkArray},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.bookmark;return[r.shortcut?n("button",{attrs:{title:"移除快捷方式"},on:{click:function(e){return t.removeShortcut(r)}}},[n("i",{staticClass:"fas fa-unlink"})]):n("button",{attrs:{title:"加入快捷方式"},on:{click:function(e){return t.addShortcut(r)}}},[n("i",{staticClass:"fas fa-link"})]),t._v(" "),n("button",{on:{click:function(e){return t.edit(r)}}},[n("i",{staticClass:"fas fa-edit"})]),t._v(" "),n("button",{on:{click:function(e){return t.remove(r)}}},[n("i",{staticClass:"far fa-trash-alt"})]),t._v(" "),n("button",[t._v(t._s(r.visit.count))])]}}])})],1)},[],!1,null,"7f831876",null);e.default=d.exports},54:function(t,e,n){"use strict";var r=n(28);function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){i(t,e,n[e])})}return t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a={name:"list-tool-bar",props:{paths:Array,sortOptions:Array,count:Number},data:function(){return{sortBy:""}},computed:o({},Object(r.c)({ui:"ui"}),{reverse:{get:function(){return this.$store.state.ui.list.reverse},set:function(t){this.$store.commit("updateUi",["list.reverse",t])}}}),methods:o({},Object(r.b)({updateUi:"updateUi"}))},c=(n(563),n(5)),s=Object(c.a)(a,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tool-bar"},[t.paths?n("div",{staticClass:"paths"},t._l(t.paths,function(e){return e.title?n("router-link",{key:e.id,attrs:{to:"/node/"+e.id}},[t._v("\n              "+t._s(e.title)+"   >\n        ")]):t._e()}),1):t._e(),t._v(" "),t.sortOptions?n("div",{staticClass:"select is-small"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.sortBy,expression:"sortBy"}],on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.sortBy=e.target.multiple?n:n[0]},function(e){return t.$emit("sortByChange",e.target.value)}]}},t._l(t.sortOptions,function(e){return n("option",{domProps:{value:e.value}},[t._v(t._s(e.text))])}),0)]):t._e(),t._v(" "),n("div",[n("label",{staticClass:"checkbox"},[t._v("\n              "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.reverse,expression:"reverse"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.reverse)?t._i(t.reverse,null)>-1:t.reverse},on:{change:function(e){var n=t.reverse,r=e.target,o=!!r.checked;if(Array.isArray(n)){var i=t._i(n,null);r.checked?i<0&&(t.reverse=n.concat([null])):i>-1&&(t.reverse=n.slice(0,i).concat(n.slice(i+1)))}else t.reverse=o}}}),t._v("\n            排序反转\n        ")])]),t._v(" "),n("div"),t._v(" "),n("div",{staticClass:"flex-shrink-right"},[t._t("default")],2),t._v(" "),t.count?n("div",{staticClass:"counter"},[t._v(" 共 "+t._s(t.count)+" 项")]):t._e(),t._v(" "),n("div",{staticClass:"show-type"},[n("button",{class:{active:"list"===t.ui.list.showType},on:{click:function(e){return t.updateUi(["list.showType","list"])}}},[n("i",{staticClass:"fa fa-list"})]),t._v(" "),n("button",{class:{active:"grid"===t.ui.list.showType},on:{click:function(e){return t.updateUi(["list.showType","grid"])}}},[n("i",{staticClass:"fa fa-th"})])])])},[],!1,null,"3ec8fb58",null);e.a=s.exports},563:function(t,e,n){"use strict";var r=n(158);n.n(r).a},564:function(t,e,n){"use strict";var r=n(160);n.n(r).a},565:function(t,e,n){"use strict";var r=n(161);n.n(r).a},566:function(t,e,n){"use strict";var r=n(162);n.n(r).a},567:function(t,e,n){"use strict";var r=n(163);n.n(r).a},568:function(t,e,n){"use strict";var r=n(164);n.n(r).a},569:function(t,e){t.exports="img/7360254d509706d9b22a3d60d852bc86.png"},570:function(t,e,n){"use strict";var r=n(165);n.n(r).a},6:function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){return function(t){if(Array.isArray(t))return t}
/*!
 * 一个工具函数, 用于生成chrome api相同接口的包装对象
 * 但是包装对象的接口支持promise,
 * 同时提供一个on方法, 添加事件监听器的简洁写法
 * example:
 * // 原生接口调用
 * chrome.tabs.getCurrent(tab => tab)
 * // 包装对象调用
 * const tabs = wrapApi(chrome.tabs)
 * tabs.getCurrent().then(tab => tab)
 * tabs.on('onCreated', tab => tab)
 *
 * Created by j on 2019-01-12.
 */(t)||function(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.events=e.events||[];e.api=t;for(var i=Object.entries(t),a=0;a<i.length;a++){var c=o(i[a],2),s=c[0],u=c[1];"function"==typeof u?e[s]=function(n){return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return console.log("chrome API Invoking => ".concat(e.name,".").concat(n),"args =>",o),new Promise(function(e,r){o.push(function(t){e(t)}),t[n].apply(t,o)})}}(s):"object"===r(u)&&s.startsWith("on")&&n.push(s)}return e.on=function(t,n){n||(n=t,t=void 0);var r=this.events,o=this.api;t=t||r;var i=(t=Array.isArray(t)?t:[t]).length>1?"unshift":"push";t.forEach(function(t){console.log("addListener for ".concat(e.name,"."),t),r.includes(t)&&o[t].addListener(function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];console.log(t,r),r[i](t),n.apply(null,r)})})},e}
/*!
 * 
 * Created by j on 2019-01-13.
 */var a=i(chrome.downloads);function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}
/*!
 * chrome.bookmarks wrapper
 * Created by j on 2019-01-05.
 */var s=i(chrome.bookmarks,{name:"bookmarks"}),u={on:function(t,e){return s.on(t,e)},get:function(t){return s.get(t)},add:function(t){return this.create(t)},create:function(t){var e={};return e.title=t.title,e.url=t.url,t.parentId&&(e.parentId=t.parentId),s.create(e)},recover:function(t){var e={};return e.title=t.title,e.url=t.url,e.parentId=t.parentId,e.index=t.index,s.create(e)},remove:function(t){return t.url?s.remove(t.id):s.removeTree(t.id)},update:function(t){var e=t.id,n=t.title,r=t.url,o=t.parentId;if(o)return this.move(e,{parentId:o}).then(function(t){return s.update(e,{title:n,url:r})})},move:function(t,e){var n="object"===c(t)?t.id:t;return s.move(n,e)},getChildren:function(t){return s.getChildren(t)},getTree:function(t){return s.getTree().then(function(e){return t&&function t(e){for(var n=e.length;n--;){var r=e[n];r.title=r.title||"根目录",r.name=r.title,r.children?(r.value=r.children.length,t(r.children)):e.splice(n,1)}}(e),e})},getSubTree:function(t,e){return s.getSubTree(t).then(function(t){return e&&function t(e){for(var n=e.length;n--;){var r=e[n];r.name=r.title||"root",r.children?(r.value=r.children.length,t(r.children)):e.splice(n,1)}}(t),t})},getRecent:function(t){return s.getRecent(t||100)},search:function(t){return s.search(t)}},l=(i(chrome.storage,{name:"storage"}),i(chrome.tabs,{name:"tabs"}));i(chrome.tabs);n.d(e,"b",function(){return a}),n.d(e,"a",function(){return u}),n.d(e,"c",function(){return l})},69:function(t,e,n){"use strict";var r=n(180),o=n(28),i=n(22);function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){c(t,e,n[e])})}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object(i.b)("shortcut");var s={name:"list",components:{listItem:r.a},props:{bookmarkArray:Array,showType:{type:String,default:""}},data:function(){return{listType:""}},computed:a({},Object(o.c)({ui:"ui"})),mounted:function(){window.innerWidth<900&&(this.listType="grid",this.updateUi(["list.showType","grid"]))},methods:a({},Object(o.b)({updateUi:"updateUi"}),{onContextmenu:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];console.log("contextmenu",e),this.$emit("contextmenu",e)}}),watch:{"ui.list.showType":function(t,e){this.listType=t}}},u=(n(570),n(5)),l=Object(u.a)(s,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("ul",{class:t.listType||t.showType||t.ui.list.showType},t._l(t.bookmarkArray,function(e){return n("list-item",{key:e.id,attrs:{bookmark:e},on:{contextmenu:t.onContextmenu}},[t._t("default",null,{bookmark:e})],2)}),1)])},[],!1,null,"7716b9f9",null);e.a=l.exports},70:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r,o=n(29),i=n(103),a=n(179),c={data:{visible:!0,exit:!1,bookmark:{}},render:function(t){var e=this,n=this.bookmark&&t(a.a,{slot:"default",props:{bookmark:this.$clone(this.bookmark)},on:{close:function(){e.visible=!1,e.bookmark=null}}}),r={props:{value:this.visible}};return t(i.b,r,[n])}};function s(t){r||((r=r||new o.a(c)).$mount(document.createElement("div")),document.body.appendChild(r.$el)),(r=r).bookmark=t,r.visible=!0}function u(t){s({title:"新建文件夹",parentId:t.id})}e.b=s},877:function(t,e,n){"use strict";var r=n(171);n.n(r).a}}]);
//# sourceMappingURL=common.js.map