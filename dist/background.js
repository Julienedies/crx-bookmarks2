(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["background"],{

/***/ "./pages/app/background.js":
/*!*********************************!*\
  !*** ./pages/app/background.js ***!
  \*********************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _libs_chrome__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../libs/chrome */ \"./libs/chrome/index.js\");\n/* harmony import */ var _libs_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../libs/db */ \"./libs/db.js\");\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/*!\n * \n * Created by j on 2019-01-11.\n */\n\n\nvar trashDb = Object(_libs_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"])('trash');\nvar visitDb = Object(_libs_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"])('visit');\nvar shortcutDb = Object(_libs_db__WEBPACK_IMPORTED_MODULE_1__[\"default\"])('shortcut'); // 当一个书签被删除, 把它保存到db\n\n_libs_chrome__WEBPACK_IMPORTED_MODULE_0__[\"bookmarks\"].on('onRemoved', function (id, changeInfo, event) {\n  var obj = _objectSpread({\n    index: changeInfo.index,\n    parentId: changeInfo.parentId\n  }, changeInfo.node);\n\n  console.log('保存到回收站', obj);\n  trashDb.set(obj); // 一个书签被删除后, 需要删除其它相关数据\n\n  visitDb.remove(id);\n  shortcutDb.remove(id);\n});\n\nvar f = function f(tab) {\n  if (!tab.url) return;\n  _libs_chrome__WEBPACK_IMPORTED_MODULE_0__[\"bookmarks\"].search(tab.url).then(function (list) {\n    list.forEach(function (bookmark) {\n      if (bookmark.url === tab.url) {\n        console.log('添加新访问记录 => ', bookmark);\n        visitDb.get(bookmark.id).then(function (record) {\n          record = record || {\n            id: bookmark.id,\n            count: 0\n          };\n          record.count += 1;\n          visitDb.set(record);\n        });\n      }\n    });\n  });\n};\n\n_libs_chrome__WEBPACK_IMPORTED_MODULE_0__[\"tabs\"].on(function () {//console.log(args)\n}); // 记录浏览器访问记录, 统计最常使用的书签\n\n/*tabs.on('onCreated', (tab, event)=> {\n    f(tab)\n})*/\n\n_libs_chrome__WEBPACK_IMPORTED_MODULE_0__[\"tabs\"].on('onUpdated', function (tabId, changeInfe, tab, event) {\n  console.log(tab.status);\n  tab.status === 'complete' && f(tab);\n});\n/*tabs.on('onReplaced', function (addedTabId, removedTabId, event) {\n    tabs.get(addedTabId).then(tab => {\n        f(tab)\n    })\n})*///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWdlcy9hcHAvYmFja2dyb3VuZC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3BhZ2VzL2FwcC9iYWNrZ3JvdW5kLmpzPzljNWYiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBcbiAqIENyZWF0ZWQgYnkgaiBvbiAyMDE5LTAxLTExLlxuICovXG5cbmltcG9ydCB7IGJvb2ttYXJrcywgdGFicyB9IGZyb20gJy4uLy4uL2xpYnMvY2hyb21lJ1xuXG5pbXBvcnQgZ2V0RGIgZnJvbSAnLi4vLi4vbGlicy9kYidcblxuY29uc3QgdHJhc2hEYiA9IGdldERiKCd0cmFzaCcpXG5jb25zdCB2aXNpdERiID0gZ2V0RGIoJ3Zpc2l0JylcbmNvbnN0IHNob3J0Y3V0RGIgPSBnZXREYignc2hvcnRjdXQnKVxuXG4vLyDlvZPkuIDkuKrkuabnrb7ooqvliKDpmaQsIOaKiuWug+S/neWtmOWIsGRiXG5ib29rbWFya3Mub24oJ29uUmVtb3ZlZCcsIGZ1bmN0aW9uIChpZCwgY2hhbmdlSW5mbywgZXZlbnQpIHtcblxuICAgIGxldCBvYmogPSB7XG4gICAgICAgIGluZGV4OiBjaGFuZ2VJbmZvLmluZGV4LFxuICAgICAgICBwYXJlbnRJZDogY2hhbmdlSW5mby5wYXJlbnRJZCxcbiAgICAgICAgLi4uY2hhbmdlSW5mby5ub2RlXG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ+S/neWtmOWIsOWbnuaUtuermScsIG9iailcblxuICAgIHRyYXNoRGIuc2V0KG9iailcblxuICAgIC8vIOS4gOS4quS5puetvuiiq+WIoOmZpOWQjiwg6ZyA6KaB5Yig6Zmk5YW25a6D55u45YWz5pWw5o2uXG4gICAgdmlzaXREYi5yZW1vdmUoaWQpXG4gICAgc2hvcnRjdXREYi5yZW1vdmUoaWQpXG5cbn0pXG5cbmNvbnN0IGYgPSBmdW5jdGlvbiAodGFiKSB7XG4gICAgaWYgKCF0YWIudXJsKSByZXR1cm5cbiAgICBib29rbWFya3Muc2VhcmNoKHRhYi51cmwpLnRoZW4obGlzdCA9PiB7XG4gICAgICAgIGxpc3QuZm9yRWFjaChib29rbWFyayA9PiB7XG4gICAgICAgICAgICBpZiAoYm9va21hcmsudXJsID09PSB0YWIudXJsKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+a3u+WKoOaWsOiuv+mXruiusOW9lSA9PiAnLCBib29rbWFyaylcbiAgICAgICAgICAgICAgICB2aXNpdERiLmdldChib29rbWFyay5pZCkudGhlbihyZWNvcmQgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZWNvcmQgPSByZWNvcmQgfHwge2lkOiBib29rbWFyay5pZCwgY291bnQ6IDB9XG4gICAgICAgICAgICAgICAgICAgIHJlY29yZC5jb3VudCArPSAxXG4gICAgICAgICAgICAgICAgICAgIHZpc2l0RGIuc2V0KHJlY29yZClcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pXG59XG5cbnRhYnMub24oKC4uLmFyZ3MpID0+IHtcbiAgICAvL2NvbnNvbGUubG9nKGFyZ3MpXG59KVxuXG5cbi8vIOiusOW9lea1j+iniOWZqOiuv+mXruiusOW9lSwg57uf6K6h5pyA5bi45L2/55So55qE5Lmm562+XG4vKnRhYnMub24oJ29uQ3JlYXRlZCcsICh0YWIsIGV2ZW50KT0+IHtcbiAgICBmKHRhYilcbn0pKi9cblxudGFicy5vbignb25VcGRhdGVkJywgZnVuY3Rpb24gKHRhYklkLCBjaGFuZ2VJbmZlLCB0YWIsIGV2ZW50KSB7XG4gICAgY29uc29sZS5sb2codGFiLnN0YXR1cylcbiAgICB0YWIuc3RhdHVzID09PSAnY29tcGxldGUnICYmIGYodGFiKVxufSlcblxuLyp0YWJzLm9uKCdvblJlcGxhY2VkJywgZnVuY3Rpb24gKGFkZGVkVGFiSWQsIHJlbW92ZWRUYWJJZCwgZXZlbnQpIHtcbiAgICB0YWJzLmdldChhZGRlZFRhYklkKS50aGVuKHRhYiA9PiB7XG4gICAgICAgIGYodGFiKVxuICAgIH0pXG59KSovXG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7OztBQUtBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUtBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7Ozs7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./pages/app/background.js\n");

/***/ }),

/***/ 2:
/*!**************************************************************************************************************************************************************************************************!*\
  !*** multi ../node_modules/webpack-dev-server/client?http://localhost:9083 ../node_modules/webpack/hot/dev-server.js webpack-dev-server/client?http://localhost:9083/ ./pages/app/background.js ***!
  \**************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(/*! /Users/j/dev/crx-bookmarks2/node_modules/webpack-dev-server/client/index.js?http://localhost:9083 */"../node_modules/webpack-dev-server/client/index.js?http://localhost:9083");
__webpack_require__(/*! /Users/j/dev/crx-bookmarks2/node_modules/webpack/hot/dev-server.js */"../node_modules/webpack/hot/dev-server.js");
__webpack_require__(/*! webpack-dev-server/client?http://localhost:9083/ */"../node_modules/webpack-dev-server/client/index.js?http://localhost:9083/");
module.exports = __webpack_require__(/*! ./pages/app/background.js */"./pages/app/background.js");


/***/ })

},[[2,"runtime","vendors","common"]]]);